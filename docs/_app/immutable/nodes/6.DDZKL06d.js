import{t as j,a as x,c as ne}from"../chunks/DrDwaiBy.js";import"../chunks/BPGHJWI2.js";import{p as le,t as A,o as e,a as me,s as l,c as a,x as o,D as m,b as s,aj as ce,ak as pe}from"../chunks/DMgRPyFJ.js";import{e as L,r as ue,s as U}from"../chunks/DdMn_Oyi.js";import{i as de}from"../chunks/CFSjT7ar.js";import{e as fe,i as ve}from"../chunks/DU0MZw2q.js";import{r as z,a as ge,s as be}from"../chunks/DJvQYuIs.js";import{b as T,t as N}from"../chunks/q-9YxcVR.js";import{i as he}from"../chunks/BQwoijYz.js";import{s as we,a as E,b as _e}from"../chunks/BmmjJtSI.js";import{o as xe}from"../chunks/BjBEmkcC.js";import{u as R,p as V}from"../chunks/H-dT48qA.js";import{g as ye}from"../chunks/DA7NjsCN.js";import{b as $e}from"../chunks/BS74L_PC.js";function F(c){return function(...f){var v=f[0];return v.preventDefault(),c==null?void 0:c.apply(this,f)}}var ke=j('<img alt="attached by user">'),Ie=j("<p>No images attached yet</p>"),Se=j('<main class="dark:bg-surface-900 bg-surface-50 svelte-yws3we"><form class="svelte-yws3we"><div id="topBar" class="svelte-yws3we"><h1>Create a post here...</h1> <p> </p> <button type="submit"> </button></div> <input placeholder="Title" type="text" required class="inputBox text-black dark:bg-surface-100 svelte-yws3we"> <textarea placeholder="Main Paragraph" required class="inputBox text-black dark:bg-surface-100 svelte-yws3we"></textarea></form> <aside id="toolSelector" class="svelte-yws3we"><form class="svelte-yws3we"><input placeholder="Paste image url here" type="text" required class="inputBox text-black dark:bg-surface-100 svelte-yws3we"> <button type="submit" class="border2px fancyText btn transition-all duration-1000 preset-outlined-secondary-200-800 svelte-yws3we">Attach image</button></form> <label for="attachedImagesShowcase">Attached Images:</label> <div id="attachedImagesShowcase" class="svelte-yws3we"><!></div></aside></main>');function ze(c,f){le(f,!1);const[v,G]=we(),H=()=>E(V,"$posts_store",v),K=()=>E(R,"$user",v);let y=m(""),$=m(""),i=m([]),Q=[],q="",p=m(""),g=m(""),k=[],b=m(!1);xe(()=>{k=JSON.parse(H()),q=R?JSON.parse(K()):""});function W(){const t="abcdefghijklmnopqrstuvwxyz",r="0123456789",u=()=>t[Math.floor(Math.random()*t.length)],d=()=>r[Math.floor(Math.random()*r.length)];let n="";do n=`${d()}${d()}${d()}${u()}${u()}${u()}`;while(k.some(_=>_.id===n));return console.log(n),n}function X(){if(e(b)){ye($e+"/post/"+e(g));return}o(g,W());const t={id:e(g),author:q,header:e(y),text:e($),date:new Date().toISOString(),likes:0,dislikes:0,attachedImages:e(i),comments:[],tags:Q};_e(V,JSON.stringify([...k,t])),o(b,!0),Z()}function Y(){e(p).match(/\.(jpeg|jpg|gif|png)$/i)?(e(i).push(e(p)),o(i,e(i)),ee(),o(p,"")):te()}function Z(){N.success("Post posted!")}function ee(){N.success("Image attached")}function te(){N.error("Invalid image URL")}he();var I=Se(),h=a(I),S=a(h),P=l(a(S),2),ae=a(P,!0);s(P);var D=l(P,2),se=a(D,!0);s(D),s(S);var M=l(S,2);z(M);var B=l(M,2);ue(B),s(h);var O=l(h,2),w=a(O),C=a(w);z(C),ce(2),s(w);var J=l(w,4),re=a(J);{var oe=t=>{var r=ne(),u=pe(r);fe(u,1,()=>e(i),ve,(d,n)=>{var _=ke();A(()=>be(_,"src",e(n))),x(d,_)}),x(t,r)},ie=t=>{var r=Ie();x(t,r)};de(re,t=>{e(i).length>0?t(oe):t(ie,!1)})}s(J),s(O),s(I),A(()=>{U(ae,e(g)),ge(D,1,`border2px fancyText btn transition-all duration-1000 ${(e(b)?"preset-outlined-white bg-primary-950":"preset-outlined-primary-50-950")??""}`,"svelte-yws3we"),U(se,e(b)?"View Post":"Create Post")}),T(M,()=>e(y),t=>o(y,t)),T(B,()=>e($),t=>o($,t)),L("submit",h,F(X)),T(C,()=>e(p),t=>o(p,t)),L("submit",w,F(Y)),x(c,I),me(),G()}export{ze as component};
