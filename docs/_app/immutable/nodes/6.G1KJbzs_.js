import{t as D,a as x,c as nt}from"../chunks/v1_vH7I-.js";import"../chunks/D-VnxlO6.js";import{p as lt,t as J,C as t,a as mt,s as l,c as a,a4 as o,N as m,b as s,aj as ct,ak as pt}from"../chunks/aESudJSf.js";import{e as A,r as ut,s as L}from"../chunks/CWpw8rZ0.js";import{i as dt}from"../chunks/BhFMOSSI.js";import{e as ft,i as vt}from"../chunks/B-PhJm5Y.js";import{r as U,a as gt,s as bt}from"../chunks/DObYIZTe.js";import{b as N,t as T}from"../chunks/BLN0KxYt.js";import{i as ht}from"../chunks/CQq73GT9.js";import{s as _t,a as E,b as yt}from"../chunks/iziWAJvg.js";import{o as xt}from"../chunks/DL-0HI8G.js";import{u as R,p as V}from"../chunks/D9fJ174B.js";import{g as kt}from"../chunks/C8e9z2ce.js";import{b as $t}from"../chunks/BqLx3KMS.js";function F(c){return function(...f){var v=f[0];return v.preventDefault(),c==null?void 0:c.apply(this,f)}}var zt=D('<img alt="attached by user">'),It=D("<p>No images attached yet</p>"),wt=D('<main class="dark:bg-surface-900 bg-surface-50 svelte-zk7y4m"><form class="svelte-zk7y4m"><div id="topBar" class="svelte-zk7y4m"><h1>Create a post here...</h1> <p> </p> <button type="submit"> </button></div> <input placeholder="Title" type="text" required class="inputBox text-black dark:bg-surface-100 svelte-zk7y4m"> <textarea placeholder="Main Paragraph" required class="inputBox text-black dark:bg-surface-100 svelte-zk7y4m"></textarea></form> <aside id="toolSelector" class="svelte-zk7y4m"><form class="svelte-zk7y4m"><input placeholder="Paste image url here" type="text" required class="inputBox text-black dark:bg-surface-100 svelte-zk7y4m"> <button type="submit" class="border2px fancyText btn transition-all duration-1000 preset-outlined-secondary-200-800 svelte-zk7y4m">Attach image</button></form> <label for="attachedImagesShowcase">Attached Images:</label> <div id="attachedImagesShowcase" class="svelte-zk7y4m"><!></div></aside></main>');function Ut(c,f){lt(f,!1);const[v,G]=_t(),H=()=>E(V,"$posts_store",v),K=()=>E(R,"$user",v);let k=m(""),$=m(""),i=m([]),Q=[],j="",p=m(""),g=m(""),z=[],b=m(!1);xt(()=>{z=JSON.parse(H()),j=R?JSON.parse(K()):""});function W(){const e="abcdefghijklmnopqrstuvwxyz",r="0123456789",u=()=>e[Math.floor(Math.random()*e.length)],d=()=>r[Math.floor(Math.random()*r.length)];let n="";do n=`${d()}${d()}${d()}${u()}${u()}${u()}`;while(z.some(y=>y.id===n));return console.log(n),n}function X(){if(t(b)){kt($t+"/post/"+t(g));return}o(g,W());const e={id:t(g),author:j,header:t(k),text:t($),date:new Date().toISOString(),likes:0,dislikes:0,attachedImages:t(i),comments:[],tags:Q};yt(V,JSON.stringify([...z,e])),o(b,!0),Z()}function Y(){t(p).match(/\.(jpeg|jpg|gif|png)$/i)?(t(i).push(t(p)),o(i,t(i)),tt(),o(p,"")):et()}function Z(){T.success("Post posted!")}function tt(){T.success("Image attached")}function et(){T.error("Invalid image URL")}ht();var I=wt(),h=a(I),w=a(h),S=l(a(w),2),at=a(S,!0);s(S);var P=l(S,2),st=a(P,!0);s(P),s(w);var M=l(w,2);U(M);var q=l(M,2);ut(q),s(h);var B=l(h,2),_=a(B),C=a(_);U(C),ct(2),s(_);var O=l(_,4),rt=a(O);{var ot=e=>{var r=nt(),u=pt(r);ft(u,1,()=>t(i),vt,(d,n)=>{var y=zt();J(()=>bt(y,"src",t(n))),x(d,y)}),x(e,r)},it=e=>{var r=It();x(e,r)};dt(rt,e=>{t(i).length>0?e(ot):e(it,!1)})}s(O),s(B),s(I),J(()=>{L(at,t(g)),gt(P,1,`border2px fancyText btn transition-all duration-1000 ${(t(b)?"preset-outlined-white bg-primary-950":"preset-outlined-primary-50-950")??""}`,"svelte-zk7y4m"),L(st,t(b)?"View Post":"Create Post")}),N(M,()=>t(k),e=>o(k,e)),N(q,()=>t($),e=>o($,e)),A("submit",h,F(X)),N(C,()=>t(p),e=>o(p,e)),A("submit",_,F(Y)),x(c,I),mt(),G()}export{Ut as component};
